<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Reminder App</title>
    <style>
      :root {
        --bg: #ffffff;
        --text: #000000;
        --muted: #666;
        --accent: #4CAF50;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
        background: var(--bg);
        color: var(--text);
      }

      /* Sidebar */
      .sidebar {
        width: 220px;
        background: #666;
        color: #fff;
        position: fixed;
        height: 100%;
        left: 0;
        display: flex;
        flex-direction: column;
        padding: 12px;
        gap: 8px;
      }
      .profile {
        display:flex;
        align-items:center;
        gap:10px;
        margin-bottom:4px;
      }

      /* Buttons */
      .menu-btn, .icon-btn, .add-btn {
        display:block;
        width:100%;
        padding:10px;
        border: none;
        background:#888;
        color:#fff;
        border-radius:6px;
        cursor:pointer;
        text-align:left;
        font-size:15px;
      }
      .menu-btn:hover, .icon-btn:hover, .add-btn:hover { background:#aaa; }

      /* Main area */
      .main {
        margin-left: 220px;
        padding: 20px;
        min-height: 100vh;
        transition: margin-left .25s;
      }

      /* pages */
      .page.hidden { display:none; }

      /* Toggle (sidebar) */
      .toggle-btn {
        position: absolute;
        left: 230px;
        top: 12px;
        padding:6px 8px;
        border-radius:6px;
        border:none;
        background:#ddd;
        cursor:pointer;
      }

      /* Lists & forms */
      .list { list-style:none; padding:0; margin:0 0 12px 0; }
      .list li {
        display:flex;
        align-items:center;
        justify-content:space-between;
        padding:8px;
        border-radius:6px;
        margin-bottom:8px;
        background: rgba(0,0,0,0.03);
      }
      .item-left { display:flex; flex-direction:column; gap:4px; }
      .badge { background:#eee; padding:4px 8px; border-radius:12px; font-size:12px; }

      /* form */
      .form {
        margin-top: 0;
        padding: 12px;
        border-radius: 8px;
        background: #f5f5f5;
        display: flex;
        flex-direction: column;
        gap: 8px;
        max-width: 520px;
        overflow: hidden;
        transition: max-height 0.3s ease, padding 0.3s ease;
        max-height: 0;
        padding-top: 0;
        padding-bottom: 0;
      }
      .form.visible {
        max-height: 500px; /* large enough for content */
        padding-top: 12px;
        padding-bottom: 12px;
      }
      .form label {
        display:flex;
        flex-direction:column;
        font-size:13px;
        gap:6px;
      }
      .form input[type="text"], .form input[type="date"], .form textarea {
        padding:8px;
        border-radius:6px;
        border:1px solid #ccc;
      }
      .form-actions {
        display:flex;
        gap:8px;
        margin-top:6px;
      }
      .primary {
        background: var(--accent);
        color: #fff;
        border:none;
        padding:8px 12px;
        border-radius:6px;
        cursor:pointer;
      }
      .secondary {
        background:#ddd;
        border:none;
        padding:8px 12px;
        border-radius:6px;
        cursor:pointer;
      }

      /* small buttons inside list */
      .icon-small {
        background:transparent;
        border:none;
        cursor:pointer;
        margin-left:8px;
        font-size:16px;
      }

      .add-area {
        margin-top: 8px;
        max-width: 520px;
      }

      /* Dark mode */
      .dark {
        --bg: #121212;
        --text: #f1f1f1;
      }
      .dark .main { background:#151515; color:var(--text); }
      .dark .form { background: #232323; }
      .dark .menu-btn, .dark .icon-btn { background:#333; color:var(--text); }

      /* Add New Reminder Button with arrow */
      #showAddFormBtn, #homeRemindersToggle {
        position: relative;
        user-select: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        font-size: 16px;
        cursor: pointer;
      }
      #showAddFormBtn .arrow, #homeRemindersToggle .arrow {
        transition: transform 0.3s ease;
        font-size: 14px;
      }
      #showAddFormBtn.open .arrow, #homeRemindersToggle.open .arrow {
        transform: rotate(180deg);
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar">
      <div class="profile">
        <img
          id="profilePhoto"
          src="https://via.placeholder.com/40"
          alt="Profile"
          width="40"
          height="40"
          style="border-radius:50%;object-fit:cover;cursor:pointer;"
          onclick="document.getElementById('photoUpload').click()"
        />
        <h3 id="profileName">üë§ User</h3>
      </div>

      <input
        id="photoUpload"
        type="file"
        accept="image/*"
        style="display:none;"
      />

      <button class="menu-btn" id="editNameBtn">‚úèÔ∏è Edit Name</button>
      <button class="menu-btn" data-page="home">üè† Home</button>
      <button class="menu-btn" data-page="reminders">‚è∞ Reminders</button>
      <button class="menu-btn" data-page="notes">üìù Notes</button>

      <!-- dark mode stuck to bottom -->
      <button id="darkModeBtn" class="icon-btn" style="margin-top:auto;">
        üåô Dark Mode
      </button>
    </div>

    <!-- Main -->
    <div id="main" class="main">
      <button id="toggleBtn" class="toggle-btn">‚Æú</button>

      <!-- Home -->
      <div id="home" class="page">
        <h2>Home</h2>
        <div class="add-area">
          <button
            id="homeRemindersToggle"
            class="add-btn"
            aria-expanded="false"
          >
            ‚ö†Ô∏è Urgent/Expired Reminders <span class="arrow">‚ñº</span>
          </button>
          <div
            id="homeRemindersContainer"
            class="form"
            aria-hidden="true"
          ></div>
        </div>
      </div>

      <!-- Reminders -->
      <div id="reminders" class="page hidden">
        <h2>Reminders</h2>

        <!-- Add new with collapsible -->
        <div class="add-area">
          <button id="showAddFormBtn" class="add-btn" aria-expanded="false">
            Ôºã Add New Reminder <span class="arrow">‚ñº</span>
          </button>
          <div id="reminderFormContainer" class="form" aria-hidden="true">
            <label>
              Title
              <input id="reminderTitle" type="text" placeholder="Title" />
            </label>
            <label>
              Start date
              <input id="startDate" type="date" />
            </label>
            <label>
              End date
              <input id="endDate" type="date" />
            </label>

            <div class="form-actions">
              <button id="saveReminderBtn" class="primary">Save</button>
              <button id="cancelReminderBtn" class="secondary">Cancel</button>
            </div>
          </div>
        </div>

        <!-- List -->
        <ul id="reminderList" class="list"></ul>
      </div>

      <!-- Notes -->
      <div id="notes" class="page hidden">
        <h2>Personal Notes</h2>
        <form id="noteForm">
          <label>
            Label
            <input id="noteLabel" type="text" required />
          </label>
          <label>
            Note
            <textarea id="noteText" rows="4"></textarea>
          </label>
          <div class="form-actions">
            <button type="submit" class="primary">Add</button>
          </div>
        </form>

        <ul id="noteList" class="list"></ul>
      </div>
    </div>

    <script>
      (function () {
        const STORAGE_KEYS = {
          reminders: 'app_reminders_v1',
          notes: 'app_notes_v1',
          profileName: 'app_profile_name_v1',
          profilePhoto: 'app_profile_photo_v1',
          darkMode: 'app_dark_mode_v1'
        };

        let reminders = JSON.parse(localStorage.getItem(STORAGE_KEYS.reminders)) || [];
        let notes = JSON.parse(localStorage.getItem(STORAGE_KEYS.notes)) || [];
        let editingIndex = null;

        function byId(id) { return document.getElementById(id); }

        function saveAll() {
          localStorage.setItem(STORAGE_KEYS.reminders, JSON.stringify(reminders));
          localStorage.setItem(STORAGE_KEYS.notes, JSON.stringify(notes));
        }

        function daysLeft(endDateStr) {
          if (!endDateStr) return 0;
          const parts = endDateStr.split('-').map(Number);
          const [y, m, d] = parts;
          const end = new Date(y, m - 1, d, 23, 59, 59, 999);
          const now = new Date();
          const diffMs = end - now;
          if (diffMs < 0) return 0;
          return Math.ceil(diffMs / (1000 * 60 * 60 * 24));
        }

        function formatDMY(dateStr) {
          if (!dateStr) return '';
          const p = dateStr.split('-');
          return `${p[2].padStart(2,'0')}/${p[1].padStart(2,'0')}/${p[0]}`;
        }

        // ---------- Render Reminders ----------
        function renderReminders() {
          const list = byId('reminderList');
          list.innerHTML = '';
          if (reminders.length === 0) {
            const li = document.createElement('li'); li.textContent='No reminders yet.'; li.style.opacity='0.7'; list.appendChild(li); return;
          }
          reminders.forEach((r,i)=>{
            const li=document.createElement('li');
            const left=document.createElement('div'); left.className='item-left';
            const title=document.createElement('div'); title.textContent=r.title; title.style.fontWeight='600';
            const dates=document.createElement('div'); dates.style.fontSize='13px'; dates.style.opacity='0.85';
            dates.textContent=`Start: ${formatDMY(r.startDate)} | End: ${formatDMY(r.endDate)}`;
            left.appendChild(title); left.appendChild(dates);
            const right=document.createElement('div'); right.style.display='flex'; right.style.alignItems='center';
            const badge=document.createElement('div'); badge.className='badge'; badge.textContent=`${daysLeft(r.endDate)} days left`;
            const editBtn=document.createElement('button'); editBtn.className='icon-small'; editBtn.textContent='‚úèÔ∏è'; editBtn.title='Edit'; editBtn.addEventListener('click',()=>editReminder(i));
            const delBtn=document.createElement('button'); delBtn.className='icon-small'; delBtn.textContent='üóëÔ∏è'; delBtn.title='Delete'; delBtn.addEventListener('click',()=>deleteReminder(i));
            right.appendChild(badge); right.appendChild(editBtn); right.appendChild(delBtn);
            li.appendChild(left); li.appendChild(right);
            list.appendChild(li);
          });
          renderHomeReminders();
        }

        // ---------- Render Home Reminders ----------
        function renderHomeReminders() {
          const container = byId('homeRemindersContainer');
          container.innerHTML = '';
          const urgent = reminders.filter(r => daysLeft(r.endDate) <= 1);
          if (urgent.length === 0) {
            const li = document.createElement('li'); li.textContent='No urgent/expired reminders.'; li.style.opacity='0.7'; container.appendChild(li); return;
          }
          urgent.forEach(r=>{
            const li = document.createElement('li'); li.className='list-item';
            const left=document.createElement('div'); left.className='item-left';
            const title=document.createElement('div'); title.textContent=r.title; title.style.fontWeight='600';
            const dates=document.createElement('div'); dates.style.fontSize='13px'; dates.style.opacity='0.85';

            left.appendChild(title); left.appendChild(dates);
            li.appendChild(left);
            container.appendChild(li);
          });
        }

        // ---------- Edit/Delete ----------
        function editReminder(i) {
          const r = reminders[i]; editingIndex=i; showForm(); byId('reminderTitle').value=r.title; byId('startDate').value=r.startDate||''; byId('endDate').value=r.endDate||''; openForm();
        }

        function deleteReminder(i) {
          if(!confirm('Are you sure you want to delete this reminder?')) return;
          reminders.splice(i,1); saveAll(); renderReminders();
        }

        // ---------- Form ----------
        function showForm(){ openForm(); }
        function clearForm(){ byId('reminderTitle').value=''; byId('startDate').value=''; byId('endDate').value=''; editingIndex=null; }
        function openForm(){ const f=byId('reminderFormContainer'); const b=byId('showAddFormBtn'); f.classList.add('visible'); b.classList.add('open'); b.setAttribute('aria-expanded','true'); f.setAttribute('aria-hidden','false'); }
        function closeForm(){ const f=byId('reminderFormContainer'); const b=byId('showAddFormBtn'); f.classList.remove('visible'); b.classList.remove('open'); b.setAttribute('aria-expanded','false'); f.setAttribute('aria-hidden','true'); }
        function toggleForm(){ const f=byId('reminderFormContainer'); if(f.classList.contains('visible')){ closeForm(); clearForm(); } else { openForm(); } }

        function saveReminder() {
          const title=byId('reminderTitle').value.trim(); const startDate=byId('startDate').value; const endDate=byId('endDate').value;
          if(!title){ alert('Please enter a title.'); return; }
          if(startDate && endDate && startDate>endDate){ alert('Start date cannot be after End date.'); return; }
          const reminder={title,startDate,endDate};
          if(editingIndex!==null){ reminders[editingIndex]=reminder; } else { reminders.push(reminder); }
          saveAll(); renderReminders(); closeForm(); clearForm();
        }

        function renderNotes() {
          const list=byId('noteList'); list.innerHTML=''; if(notes.length===0){ const li=document.createElement('li'); li.textContent='No notes yet.'; li.style.opacity='0.7'; list.appendChild(li); return; }
          notes.forEach((note,i)=>{ const li=document.createElement('li'); const left=document.createElement('div'); left.className='item-left'; const label=document.createElement('div'); label.textContent=note.label; label.style.fontWeight='600'; const text=document.createElement('div'); text.style.fontSize='13px'; text.style.opacity='0.85'; text.textContent=note.text; left.appendChild(label); left.appendChild(text); const right=document.createElement('div'); right.style.display='flex'; right.style.alignItems='center'; const delBtn=document.createElement('button'); delBtn.className='icon-small'; delBtn.textContent='üóëÔ∏è'; delBtn.title='Delete'; delBtn.addEventListener('click',()=>{ notes.splice(i,1); saveAll(); renderNotes(); }); right.appendChild(delBtn); li.appendChild(left); li.appendChild(right); list.appendChild(li); });
        }

        // ---------- Events ----------
        byId('showAddFormBtn').addEventListener('click',toggleForm);
        byId('saveReminderBtn').addEventListener('click',saveReminder);
        byId('cancelReminderBtn').addEventListener('click',()=>{ closeForm(); clearForm(); });
        byId('homeRemindersToggle').addEventListener('click',()=>{
          const c=byId('homeRemindersContainer'); c.classList.toggle('visible'); byId('homeRemindersToggle').classList.toggle('open'); const expanded=c.classList.contains('visible'); byId('homeRemindersToggle').setAttribute('aria-expanded',expanded);
        });

        document.querySelectorAll('.menu-btn[data-page]').forEach(btn=>{
          btn.addEventListener('click',()=>{
            const page=btn.getAttribute('data-page');
            document.querySelectorAll('.page').forEach(p=>p.classList.toggle('hidden',p.id!==page));
            if(page==='home'){ renderReminders(); } else if(page==='reminders'){ renderReminders(); } else if(page==='notes'){ renderNotes(); }
            closeForm(); clearForm();
          });
        });

        byId('editNameBtn').addEventListener('click',()=>{
          const newName=prompt('Enter new name:',byId('profileName').textContent);
          if(newName!==null){ byId('profileName').textContent=newName; localStorage.setItem(STORAGE_KEYS.profileName,newName); }
        });

        byId('photoUpload').addEventListener('change',function(){
          const file=this.files[0]; if(!file) return;
          const reader=new FileReader(); reader.onload=()=>{ byId('profilePhoto').src=reader.result; localStorage.setItem(STORAGE_KEYS.profilePhoto,reader.result); }; reader.readAsDataURL(file);
        });

        byId('darkModeBtn').addEventListener('click',()=>{
          document.body.classList.toggle('dark'); localStorage.setItem(STORAGE_KEYS.darkMode,document.body.classList.contains('dark')?'1':'0');
        });

        byId('noteForm').addEventListener('submit',e=>{ e.preventDefault(); const label=byId('noteLabel').value.trim(); const text=byId('noteText').value.trim(); if(!label){ alert('Please enter a label for the note.'); return; } notes.push({label,text}); saveAll(); renderNotes(); byId('noteLabel').value=''; byId('noteText').value=''; });

        const sidebar = byId('sidebar');
        const main = byId('main');
        byId('toggleBtn').addEventListener('click',()=>{
          if(sidebar.style.display==='none'){ sidebar.style.display='flex'; main.style.marginLeft='220px'; byId('toggleBtn').textContent='‚Æú'; } else { sidebar.style.display='none'; main.style.marginLeft='0'; byId('toggleBtn').textContent='‚Æû'; }
        });

        window.addEventListener('load',()=>{
          const savedName=localStorage.getItem(STORAGE_KEYS.profileName); if(savedName){ byId('profileName').textContent=savedName; }
          const savedPhoto=localStorage.getItem(STORAGE_KEYS.profilePhoto); if(savedPhoto){ byId('profilePhoto').src=savedPhoto; }
          renderReminders(); renderNotes();
          if(localStorage.getItem(STORAGE_KEYS.darkMode)==='1'){ document.body.classList.add('dark'); }
        });
      })();
    </script>
  </body>
</html>
